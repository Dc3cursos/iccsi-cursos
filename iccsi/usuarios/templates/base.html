{% load static %}
<!DOCTYPE html>
<html lang="es" data-theme="light">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}Instituto Capacitación ICCSI{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Instituto de Capacitación ICCSI - Cursos profesionales y certificaciones DC-3">
    <meta name="keywords" content="capacitación, cursos, certificaciones, DC-3, formación profesional">
    
    <!-- Google Fonts - Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Bootstrap CSS CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Custom CSS -->
    <link href="{% static 'cursos/cursos.css' %}?v=2.0" rel="stylesheet">
    <!-- Text Visibility CSS -->
    <link href="{% static 'cursos/text-visibility.css' %}?v=1.0" rel="stylesheet">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="{% static 'cursos/favicon.ico' %}">
    
    {% block extra_head %}{% endblock %}
</head>
<body>
    <!-- Page Loader -->
    <div class="page-loader" id="pageLoader">
        <div class="loader-spinner"></div>
        <div class="loader-logo">
            <i class="fas fa-graduation-cap"></i>
        </div>
    </div>

    <!-- Progress Bar -->
    <div class="progress-bar-container">
        <div class="progress-bar" id="progressBar"></div>
    </div>

    <nav class="navbar navbar-expand-lg navbar-dark mb-4">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center gap-3" href="{% url 'home' %}">
                <div class="brand-icon">
                    <i class="fas fa-graduation-cap fa-2x"></i>
                </div>
                <div class="brand-text">
                    <span class="brand-title">ICCSI</span>
                    <span class="brand-subtitle">Instituto de Capacitación</span>
                </div>
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav mx-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="{% if user.is_authenticated %}{% url 'dashboard' %}{% else %}{% url 'home' %}{% endif %}">
                            <i class="fas fa-home me-1"></i>Inicio
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'lista_cursos_con_precio' %}">
                            <i class="fas fa-book me-1"></i>Cursos
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'verificar_certificado' %}">
                            <i class="fas fa-search me-1"></i>Verificar Certificado
                        </a>
                    </li>

                    <li class="nav-item">
                        
                    </li>
                    {% if user.is_authenticated %}
                        <li class="nav-item">
                            <a class="nav-link" href="{% url 'panel_usuario' %}">
                                <i class="fas fa-tachometer-alt me-1"></i>Panel
                            </a>
                        </li>
                        {% if user.rol == "profesor" %}
                            <li class="nav-item">
                                <a class="nav-link" href="{% url 'crear_curso' %}">
                                    <i class="fas fa-plus me-1"></i>Crear Curso
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="{% url 'dashboard_pagos_profesor' %}">
                                    <i class="fas fa-chart-line me-1"></i>Dashboard de Pagos
                                </a>
                            </li>
                        {% endif %}
                        {% if user.rol == "alumno" %}
                            <li class="nav-item">
                                <a class="nav-link" href="{% url 'mis_cursos_pagados' %}">
                                    <i class="fas fa-user-graduate me-1"></i>Mis Cursos
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="{% url 'historial_pagos' %}">
                                    <i class="fas fa-credit-card me-1"></i>Mis Pagos
                                </a>
                            </li>
                        {% endif %}
                    {% endif %}
                </ul>
                
                <ul class="navbar-nav">
                    <!-- Theme Toggle -->
                    <li class="nav-item me-2">
                        <button class="theme-toggle" id="themeToggle" title="Cambiar tema">
                            <i class="fas fa-moon" id="themeIcon"></i>
                        </button>
                    </li>
                    
                    {% if user.is_authenticated %}
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" role="button" data-bs-toggle="dropdown">
                                <i class="fas fa-user-circle me-2"></i>
                                <span>{{ user.username }}</span>
                            </a>
                            <ul class="dropdown-menu dropdown-menu-end">
                                <li><a class="dropdown-item" href="{% url 'dashboard' %}">
                                    <i class="fas fa-tachometer-alt me-2"></i>Dashboard
                                </a></li>
                                <li><a class="dropdown-item" href="{% url 'panel_usuario' %}">
                                    <i class="fas fa-user me-2"></i>Mi Perfil
                                </a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item text-danger" href="{% url 'logout' %}">
                                    <i class="fas fa-sign-out-alt me-2"></i>Cerrar Sesión
                                </a></li>
                            </ul>
                        </li>
                    {% else %}
                        <li class="nav-item">
                            <a class="nav-link btn btn-outline-light btn-sm px-3" href="{% url 'login' %}">
                                <i class="fas fa-sign-in-alt me-1"></i>Iniciar Sesión
                            </a>
                        </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>

    <!-- Mensajes (toasts) -->
    <div class="toast-container position-fixed top-0 end-0 p-3" style="z-index: 1080;">
        {% if messages %}
            {% for message in messages %}
                <div class="toast align-items-center text-bg-{% if message.tags %}{{ message.tags }}{% else %}primary{% endif %} border-0" role="alert" aria-live="assertive" aria-atomic="true" data-bs-delay="4000">
                    <div class="d-flex">
                        <div class="toast-body">
                            {{ message }}
                        </div>
                        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
                    </div>
                </div>
            {% endfor %}
        {% endif %}
    </div>

    <div class="container">
        {% block content %}
        {% endblock %}
    </div>

    <footer class="footer mt-5 py-5">
        <div class="container">
            <div class="row">
                <div class="col-lg-4 mb-4">
                    <div class="footer-brand mb-3">
                        <i class="fas fa-graduation-cap fa-2x text-primary me-2"></i>
                        <span class="h5 mb-0">ICCSI</span>
                    </div>
                    <p class="text-muted">Instituto de Capacitación líder en formación profesional y certificaciones DC-3. Transformamos vidas a través de la educación de calidad.</p>
                    <div class="social-links">
                        <a href="#" class="social-link"><i class="fab fa-facebook"></i></a>
                        <a href="#" class="social-link"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="social-link"><i class="fab fa-linkedin"></i></a>
                        <a href="#" class="social-link"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
                <div class="col-lg-2 col-md-6 mb-4">
                    <h6 class="text-dark fw-bold mb-3">Cursos</h6>
                    <ul class="list-unstyled">
                        <li><a href="{% url 'lista_cursos' %}" class="footer-link">Catálogo</a></li>
                        <li><a href="#" class="footer-link">Categorías</a></li>
                        <li><a href="#" class="footer-link">Certificaciones</a></li>
                        <li><a href="#" class="footer-link">DC-3</a></li>
                    </ul>
                </div>
                <div class="col-lg-2 col-md-6 mb-4">
                    <h6 class="text-dark fw-bold mb-3">Instituto</h6>
                    <ul class="list-unstyled">
                        <li><a href="#" class="footer-link">Acerca de</a></li>
                        <li><a href="#" class="footer-link">Misión</a></li>
                        <li><a href="#" class="footer-link">Contacto</a></li>
                        <li><a href="#" class="footer-link">Ubicación</a></li>
                    </ul>
                </div>
                <div class="col-lg-2 col-md-6 mb-4">
                    <h6 class="text-dark fw-bold mb-3">Soporte</h6>
                    <ul class="list-unstyled">
                        <li><a href="{% url 'verificar_certificado' %}" class="footer-link">Verificar Certificado</a></li>
                        <li><a href="#" class="footer-link">Ayuda</a></li>
                        <li><a href="#" class="footer-link">FAQ</a></li>
                        <li><a href="#" class="footer-link">Contacto</a></li>
                    </ul>
                </div>
                <div class="col-lg-2 col-md-6 mb-4">
                    <h6 class="text-dark fw-bold mb-3">Legal</h6>
                    <ul class="list-unstyled">
                        <li><a href="{% url 'terminos' %}" class="footer-link">Términos</a></li>
                        <li><a href="{% url 'privacidad' %}" class="footer-link">Privacidad</a></li>
                        <li><a href="{% url 'cookies' %}" class="footer-link">Cookies</a></li>
                        <li><a href="{% url 'aviso_legal' %}" class="footer-link">Aviso Legal</a></li>
                        <li><a href="{% url 'reportar_falsificacion' %}" class="footer-link text-danger"><i class="fas fa-exclamation-triangle me-1"></i>Reportar Falsificación</a></li>
                    </ul>
                </div>
            </div>
            <hr class="my-4">
            <div class="row align-items-center">
                <div class="col-md-6">
                    <p class="text-muted mb-0">© {{ now|date:'Y' }} ICCSI. Todos los derechos reservados.</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p class="text-muted mb-0">
                        Hecho con <i class="fas fa-heart text-danger"></i> por ICCSI
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS CDN -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JavaScript -->
    <script>
        // Page Loader
        window.addEventListener('load', function() {
            const loader = document.getElementById('pageLoader');
            setTimeout(() => {
                loader.classList.add('hidden');
            }, 500);
        });

        // Theme Toggle
        const themeToggle = document.getElementById('themeToggle');
        const themeIcon = document.getElementById('themeIcon');
        const html = document.documentElement;
        
        // Check for saved theme preference or default to light
        const currentTheme = localStorage.getItem('theme') || 'light';
        html.setAttribute('data-theme', currentTheme);
        updateThemeIcon(currentTheme);
        
        themeToggle.addEventListener('click', function() {
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            
            html.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeIcon(newTheme);
        });
        
        function updateThemeIcon(theme) {
            if (theme === 'dark') {
                themeIcon.className = 'fas fa-sun';
            } else {
                themeIcon.className = 'fas fa-moon';
            }
        }

        // Progress Bar
        window.addEventListener('scroll', function() {
            const scrollTop = window.pageYOffset;
            const docHeight = document.body.offsetHeight - window.innerHeight;
            const scrollPercent = (scrollTop / docHeight) * 100;
            document.getElementById('progressBar').style.width = scrollPercent + '%';
        });

        // Scroll Animations
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver(function(entries) {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('animate');
                }
            });
        }, observerOptions);

        // Observe all elements with scroll-animate class
        document.addEventListener('DOMContentLoaded', function() {
            const scrollElements = document.querySelectorAll('.scroll-animate');
            scrollElements.forEach(el => observer.observe(el));
        });

        // Toast notifications
        document.addEventListener('DOMContentLoaded', function () {
            var toastElList = [].slice.call(document.querySelectorAll('.toast'))
            toastElList.forEach(function (toastEl) { 
                new bootstrap.Toast(toastEl).show() 
            })
        });

        // Notification system
        function showNotification(message, type = 'info', duration = 5000) {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <div class="d-flex align-items-center">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : type === 'warning' ? 'exclamation-triangle' : 'info-circle'} me-2"></i>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.add('show');
            }, 100);
            
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, duration);
        }

        // Global notification function
        window.showNotification = showNotification;
    </script>
    
    {% block extra_js %}{% endblock %}
</body>
</html>